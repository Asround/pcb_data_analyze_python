# 读取分类文件

我有许多xlsx表格文件. 以下进行一些介绍, 然后我会提出一些需求(用python实现).

## 介绍

​	xlsx表格文件的命名规律是固定的，整体用 - 分开成4个部分, 比如: T0.5-1-11-10

- 下面介绍一下这四个部分:
  	1.	第一个部分为字母加数字，有2～4个字符。字母有T/B两种情况，分别代表走线仅在顶层和走线在顶底两层。数字有0/0.5/1/2/4五种情况，代表了走线之间的距离是多少mm。举个例子，B0.5就是指：顶底两层走线，导线间距0.5mm；T2:顶层走线，导线间距2mm。
  	2.	第二个部分只有一个数字，代表序号，有1～2个字符。这是和第一个部分关联的。例如：B1-1和B1-2就代表了B1系列下的两个板子，序号分别为1和2。字符内容为20以内的正整数.
  	3.	第三个部分有两个字符，都是数字，且需要分开理解。第一个数字代表实验次数(取值范围；第二个数字代表实验组别：1是组别1，2是组别2。例如51就代表第五次实验，实验组别1。
  	4.	第四部分也有两个字符，均为数字，且需要分开理解。第一个数字代表辐照注量，0/1/2/3/4分别代表0/1e15/5e15/1e16/1e14；第二个为偏压大小，0/1/2/3分别代表偏压为0/50/120/240 V。例如11代表1e15辐照注量, 50V偏压.
- 一些实例:
  - T0.5-1-11-10: 顶层走线, 导线间距0.5mm, 序号1, 第1次实验, 实验组别1, 1e15辐照注量, 0V偏压
  - B2-2-72-21: 顶底两层走线, 导线间距2mm, 序号2, 第7次实验, 实验组别2, 5e15辐照注量, 50V偏压
  - T1-10-21-32: 顶层走线, 导线间距1mm, 序号10, 第2次实验, 实验组别1, 1e16辐照注量, 240V偏压
- 特殊的:
  1. 导线间距0的只有B0的情况, T0是不存在的.
  2. 序号一般不超过3. 但T1组特殊, 序号有大于10的情况, 但不超过20.
  3. 会存在 B2-2-72-21(boom), 这种命名方式, 用中文或者英文括号括起来在后面添加的内容. 只需要在后面函数中返回值加入一个", 有备注"即可.(具体我会在需求部分说明)
  4. 实验次数计数, 10用A替代, 11用B替代, 以此类推.(实际中不会有超过Z的情况)

## 需求

1. 我需要一个函数read_name, 传入xlsx表格(xlsx表格文件的路径)或者表格名字(字符串)这两种参数时, 均可以返回一个字符串, 其内容包含我之前介绍的所有东西.
   1. 比如: 传入 'T0.5-1-11-10(boom)' 字符串, 返回字符串 'T0.5-1-11-10(boom): 顶层走线, 导线间距0.5mm, 序号1, 第1次实验, 实验组别1, 1e15辐照注量, 0V偏压, 有备注'
   2. 再比如: 传入 B2-2-72-21.xlsx 表格文件(以路径形式), 返回 'B2-2-72-21: 顶底两层走线, 导线间距2mm, 序号2, 第7次实验, 实验组别2, 5e15辐照注量, 50V偏压'字符串.
2. 刚才提到的函数中, 添加多个参数(布尔值)决定是否在字符串中展示/返回某些内容:(以T0.5-1-11-10(boom)为例)
   1. show_name: True则展示 'T0.5-1-11-10(boom): '部分, 否则不展示/返回
   2. show_number: True则展示 '序号1'部分, 否则不展示/返回
   3. show_group: True则展示'实验组别1'部分, 否则不展示/返回
   4. show_tip: True则展示'有备注'部分, 否则不展示/返回 (若本身没有添加内容, 则无需展示)
3. 我需要一个分类函数sort_variable, 用于帮我按照一定规则进行表格分类.
   1. 这个函数有两个参数: 分类标准参数, sort_standard(取值: P/d/n/t/g/e/v/None), 是否全分类参数, sort_all(bool类型)
   2. 首先, 我会将表格按照如此方法存放: 一级文件夹下有很多小文件夹(二级文件夹), 二级文件夹下有所有的xlsx文件, 可能有一些其他类型的文件(如md或者txt)和文件夹, 这些都请忽略.
   3. 假设我需要按照实验次数进行分类, 那么在文件名中, 我只需要挑取第三个部分中第一个字符不一样, 但是其他字符一样的文件组成一组, 然后将他们放到一个文件夹里面即可.
      1. 举个例子: 对于 B0.5-1-11-10, 和它一组的就有: B0.5-1-21-10, B0.5-1-31-10, B0.5-1-41-10, B0.5-1-51-10, B0.5-1-61-10, B0.5-1-71-10, B0.5-1-81-10, B0.5-1-91-10, B0.5-1-A1-10, B0.5-1-B1-10....
      2. 程序需要遍历所有二级文件夹中符合'B0.5-1-t1-10'格式的(也就是t可以改变, 其他固定)文件.然后将这些文件存储到和一级文件夹同级目录下的compare_t文件夹(这个文件夹下全是文件夹, 而没有xlsx表格)下, 命名文件夹(这个指的是全装有xlsx文件的文件夹)的方式是'B0.5-1-t1-10(11)', 即将文件夹中不一样的字符串用一定占位字符代替(compare_t中的t也是占位字符), 并且在最后用括号内加数字的方式展示其中有多少个文件.
         1. 占位字符参考: Pd-n-tg-ev(这是全占位的情况, 实际上每个文件夹只会有一个占位字符)
      3. 当然, 很显然的, compare_t下还会有 B0.5-2-t1-20文件夹, T0.5-3-t1-30文件夹等等... 这个需要循环遍历实现.
         1. 但需要十分注意的,比如 B0.5-3-t1-31 这种文件是不存在的, 所以当遍历后发现没有这种文件时, 不要创建文件夹, 或者将已经创建的文件夹删除.
         2. 这种不存在的组合在所有可能的排列组合中占比较多, 务必妥善处理!
   4. 前文中提到, 有一部分的表格是像: B0.5-3-11-30(boom)这样后面有括号备注内容的. 分类时括号以及括号内内容是无效的, 不需要考虑在内. 也就是说, 按照时间分类时, B0.5-3-11-30(boom)和B0.5-3-21-30，B0.5-3-21-30认为是同一组的.
   5. 指定分类标准参数时, 全分类参数无用. 全分类参数只在分类标准参数为None(或者不传入)时可以起作用. 当不传入如何参数时, 函数不执行.

## 改进想法

